var DramaType,__awaiter=this&&this.__awaiter||function(e,i,o,c){return new(o=o||Promise)(function(t,a){function s(e){try{r(c.next(e))}catch(e){a(e)}}function n(e){try{r(c.throw(e))}catch(e){a(e)}}function r(e){var a;e.done?t(e.value):((a=e.value)instanceof o?a:new o(function(e){e(a)})).then(s,n)}r((c=c.apply(e,i||[])).next())})};import KeyAnimation from"../animation/KeyAnimation.js";import assert from"../assert/assert.js";import Message,{processMessage}from"../message/Message.js";import Setting from"../setting/Setting.js";(e=>{e.Ball="Ball",e.Function="Function",e.Image="Image",e.Code="Code",e.Answer="Answer",e.NEXT_PART="NextPart"})(DramaType=DramaType||{});class Drama{static click(){return __awaiter(this,void 0,void 0,function*(){KeyAnimation.canContinue&&(yield processMessage(),KeyAnimation.autoPlay)&&(yield this.click())})}static refresh(a){for(var[e,t]of Drama.replaceTypes)if(a.type===e){assert(null!==a.originalMessage);let e=a.originalMessage;for(var[s,n]of t)e=e.replace(s(),n());a.obj=e;break}return a}static clickOnceContains(e){return Drama.clickType.includes(e.type)}static findMessageID(a,t,s){if(0===Message.messages.length)throw new Error("Message.messages is empty");for(let e=0;e<Message.messages.length;e++){var n=Message.messages[e];if(!(void 0!==a&&n.type!==a||"string"==typeof t&&"string"==typeof n.obj&&!n.obj.includes(t)||"function"==typeof t&&"function"==typeof n.obj&&t.name!==n.obj.name||void 0!==t&&"string"!=typeof t&&"function"!=typeof t&&n.obj!==t||void 0!==s&&n.originalMessage!==s))return e}throw new Error("Message not found")}}Drama.replaceTypes=new Map([[DramaType.Ball,new Map([[()=>Setting.drama_time,()=>Message.getHelloMsg()]])]]),Drama.clickType=[DramaType.Code,DramaType.Ball];export default Drama;export{DramaType};